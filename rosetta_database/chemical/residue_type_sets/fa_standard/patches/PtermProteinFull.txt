## fullatom protein c-terminus patch

NAME PtermProteinFull
TYPES PHOSPHONATE_UPPER UPPER_TERMINUS

## general requirements for this patch

BEGIN_SELECTOR
PROPERTY PROTEIN
NOT VARIANT_TYPE UPPER_TERMINUS
NOT VARIANT_TYPE PHOSPHONATE_UPPER
PROPERTY PHOSPHONATE
END_SELECTOR

## now we search for a case that matches the residue, take the first one
## so put generic case last

BEGIN_CASE ### THE GENERAL CASE ##########################################

## these are the operations involved

ADD_ATOM  O2P   OH X -0.67
ADD_ATOM  HO2 Hpol X 0.40
ADD_BOND  Pbb O2P
ADD_BOND  O2P HO2
SET_BACKBONE_HEAVYATOM O2P
SET_POLYMER_CONNECT UPPER NONE

SET_ICOOR O2P 118.921193   76.781881    1.610194 Pbb CA  O3P
SET_ICOOR HO2 175.627742   68.310633    0.977238 O2P Pbb CA 

ADD_CHI 4  CA   Pbb  O2P   HO2 
#PROTON_CHI 4 SAMPLES 2 0 180 EXTRA 1 20 
ADD_PROTON_CHI 4 SAMPLES 2 0 180 EXTRA 1 20 
## modify properties of existing atoms

#SET_ATOM_TYPE O OO
#SET_ATOM_TYPE C COO
#SET_MM_ATOM_TYPE O OC
#SET_MM_ATOM_TYPE C CC
#SET_ATOMIC_CHARGE C 0.34
#SET_ATOMIC_CHARGE O -0.67

ADD_PROPERTY UPPER_TERMINUS ## implies terminus
ADD_PROPERTY PHOSPHONATE_UPPER

END_CASE

