## AUTHOR AND DATE
Rebecca F. Alford (ralford3@jhu.edu)
PI: Jeffrey J. Gray (Johns Hopkins ChemBE)
Test created 6/6/19

## PURPOSE OF THE TEST
The purpose of this test is to evaluate the scientific performance of franklin2019, the default energy function for membrane protein structure prediction and design. Specifically, this probes the ability of franklin2019 to discriminate near-native from non-native decoys. 

## BENCHMARK DATASET
The benchmark dataset includes five targets: Bacteriorhodopsin (BRD7; 1py6), Fumarate Reductase (FMR5; 1qla), Lactose Permease (LTPA; 1pv6), Rhodopsin (RHOD; 1u19), and V-ATPase (VATP; 2bl2). For each target, we are using two sets of decoys. The first set of decoys were generated by Yarov-Yaravoy et al. 2006 [1] through ab intio folding and include 5,000 models per target. These decoys are between 5-40Å RMSD from the native crystal structure.  The second set of decoys were generated by Dutagaci et al. 2017 [2] through molecular dynamics simulations and include between 75-110 decoys per target. these decoys are between 1-11 RMSD from the native crystal structure. 

To balance the data, we randomly selected a subset of 100 decoys from the low-resolution set. The same set of random 100 models is used for all testing. 

References for datasets: 

	1. Yarov-Yaravoy V, Schonbrun J, Baker D (2006) "Multipass membrane protein structure prediction using Rosetta" Proteins 62(4):1010-25
	2. Dutagaci B, Wittayanaraku K, Mori t, Feig M (2017) "Discrimination of native-like states of membrane proteins with implicit membrane-based scoring functions" 13(6):3049-3059.

The input files are the PDB coordinate files for each decoy and a span file generated using the mp_span_from_pdb application. The PBD coordinates were downloaded from the Orientations of Proteins in Membranes database. 

## PROTOCOL
Each decoy is refined using the RosettaMPRelax protocol with the franklin2019 energy function. The franklin2019 energy function is described in (Alford RF, Fleming PJ, Fleming KG, Gray JJ (2019) "Protein structure prediction and design in a biologically-realistic implicit membrane" Under Review) and the RosettaMPRelax protocol is described in (Alford RF, Koehler Leman J, Weitzner BD, Duran Am, Tilley DC, Elazar A, Gray JJ (2015) "An integrated framework advancing membrane protein modeling and design" PLoS Comput Biol 11(9): e1004398.)

This benchmark test takes approximately 2,000 CPU hours. 

## PERFORMANCE METRICS
We use the boltzmann-weighted RMS metric to evaluate decoy discrimination. We chose this metric because it identifes the average RMS, accounting for the likelihood of those structures occuring in nature according to their energies. This metric is further described in: 
	
	(Bhardwaj G, Mulligan VK, & Bahl CD et al. (2016) "Accurate de novo design of hyperstable constrained peptides" Nature 538(7625):329-335)

Pass/fail is defined by comparison of calculated Wrms values for this benchmark with previously established values. The test passes if within +/- 0.5Å of the established value.

In the plot generated by this test, the WRMS is shown as a blue line and the overall cutoff WRMS of +2Å RMS from the established value is shown as a red line. 

## KEY RESULTS
The calculated Wrms values are compared with baseline Wrms values from the solubleref2015 energy function and previous versions of the membrane energy function. 

## DEFINITIONS AND COMMENTS
The membrane normal and center, in addition to the coordinate frame setup are described in: 

	(Alford RF, Koehler Leman J, Weitzner BD, Duran Am, Tiley DC, Elazar A, Gray JJ (2015) "An integrated framework advancing membrane protein modeling and design" PLoS Comput. Biol. 11(9):e1004398.)

## LIMITATIONS
The PNear and Wrms metrics evaluate discrimination based on the root-mean-squared-deviation from the coordinates of the native crystal structure. While this is a good general metric for proteins, it looses information about the membrane. I'm currently thinking about ways to also capture membrane embedding into this metric. 
 
